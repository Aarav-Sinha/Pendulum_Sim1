<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        :root { 
            --neon: #00f2ff; 
            --bg: #010204; 
            --panel: rgba(10, 14, 20, 0.98); 
            --border: #222; 
        }
        
        body { margin: 0; background: var(--bg); color: var(--neon); font-family: 'Segoe UI', sans-serif; overflow: hidden; display: flex; }

        /* --- Aesthetic Cyberpunk Scrollbar --- */
        .scroll-area::-webkit-scrollbar { width: 4px; }
        .scroll-area::-webkit-scrollbar-track { background: #050505; }
        .scroll-area::-webkit-scrollbar-thumb { 
            background: #1a1a1a; 
            border-radius: 10px; 
            box-shadow: inset 0 0 5px rgba(0, 242, 255, 0.1);
        }
        .scroll-area::-webkit-scrollbar-thumb:hover { background: var(--neon); }

        #sidebar { 
            width: 320px; height: 100vh; background: var(--panel); 
            border-right: 1px solid #333; display: flex; flex-direction: column; 
            z-index: 100; box-shadow: 10px 0 30px rgba(0,0,0,0.9); 
        }
        
        .header { padding: 15px; text-align: center; border-bottom: 1px solid #333; background: rgba(0, 242, 255, 0.05); }
        .header h2 { margin: 0; font-size: 11px; letter-spacing: 5px; color: #fff; text-transform: uppercase; }

        .scroll-area { flex-grow: 1; overflow-y: auto; padding: 15px; }
        .card { background: #080808; border: 1px solid #1a1a1a; padding: 12px; border-radius: 4px; margin-bottom: 12px; }
        h3 { font-size: 8px; text-transform: uppercase; letter-spacing: 2px; margin: 0 0 10px 0; color: #5588ff; border-left: 2px solid #5588ff; padding-left: 8px; }

        .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px; }
        .input-group label { display: block; font-size: 8px; color: #888; margin-bottom: 3px; }
        input[type="number"] { width: 100%; background: #000; border: 1px solid #333; color: #fff; padding: 5px; border-radius: 2px; font-size: 11px; box-sizing: border-box; }
        input[type="range"] { width: 100%; accent-color: var(--neon); margin: 5px 0; cursor: pointer; }

        .dash { display: grid; grid-template-columns: 1fr 1fr; gap: 6px; font-family: 'Courier New', monospace; }
        .box { background: #000; padding: 6px; border: 1px solid #111; border-left: 2px solid var(--neon); }
        .box span { display: block; font-size: 8px; color: #555; }
        .box b { font-size: 11px; color: #fff; }

        .btn { width: 100%; padding: 10px; background: transparent; border: 1px solid var(--neon); color: var(--neon); cursor: pointer; font-size: 10px; font-weight: bold; margin-top: 8px; transition: 0.1s; border-radius: 3px; text-transform: uppercase; }
        .btn:hover { background: var(--neon); color: #000; }
        .btn-apply { border-color: #5588ff; color: #5588ff; }
        .btn-apply:hover { background: #5588ff; color: #fff; }

        canvas { flex-grow: 1; touch-action: none; cursor: crosshair; }
        .watermark { position: absolute; bottom: 20px; right: 30px; font-size: 12px; letter-spacing: 6px; opacity: 0.1; pointer-events: none; }
    </style>
</head>
<body>

<div id="sidebar">
    <div class="header"><h2>Pendulum Simulator</h2></div>
    <div class="scroll-area">
        <div class="card">
            <h3>Rod Dimensions</h3>
            <div class="grid-2">
                <div class="input-group"><label>L1 Length</label><input type="number" id="l1_i" value="120"></div>
                <div class="input-group"><label>L2 Length</label><input type="number" id="l2_i" value="120"></div>
            </div>
            <h3>Mass Density</h3>
            <div class="grid-2">
                <div class="input-group"><label>M1 (kg)</label><input type="number" id="m1_i" value="15"></div>
                <div class="input-group"><label>M2 (kg)</label><input type="number" id="m2_i" value="15"></div>
            </div>
        </div>

        <div class="card">
            <h3>Initial State</h3>
            <div class="grid-2">
                <div class="input-group"><label>θ1 (Deg)</label><input type="number" id="a1_i" value="90"></div>
                <div class="input-group"><label>θ2 (Deg)</label><input type="number" id="a2_i" value="45"></div>
            </div>
            <button class="btn btn-apply" onclick="applyAndReset()">Apply Configuration</button>
            <button class="btn" id="runBtn" onclick="toggleSim()">Resume Simulation</button>
        </div>

        <div class="card">
            <h3>Environment</h3>
            <label style="font-size:9px">Gravity: <span id="g_l">9.8</span></label>
            <input type="range" id="g_s" min="0" max="25" step="0.1" value="9.8">
            <label style="font-size:9px">Friction: <span id="d_l">0.000</span></label>
            <input type="range" id="d_s" min="0" max="0.1" step="0.001" value="0.000">
        </div>

        <div class="card">
            <h3>Live Telemeter</h3>
            <div class="dash">
                <div class="box"><span>ANGLE θ1</span><b id="t_a1">0°</b></div>
                <div class="box"><span>ANGLE θ2</span><b id="t_a2">0°</b></div>
                <div class="box"><span>TIME</span><b id="t_t">0.00s</b></div>
                <div class="box"><span>ENERGY</span><b id="t_e">0</b></div>
                <div class="box"><span>ω2 VEL</span><b id="t_v2">0.00</b></div>
                <div class="box"><span>α2 ACC</span><b id="t_a2_acc">0.00</b></div>
            </div>
        </div>
    </div>
</div>

<div class="watermark">AARAV SINHA</div>
<canvas id="canvas"></canvas>

<script>
const canvas = document.getElementById('canvas');
const ctx = canvas.getContext('2d');

let m1, m2, l1, l2, a1, a2, v1, v2, acc1, acc2;
let simTime = 0, isRunning = false, trail = [], dragTarget = null;

function applyAndReset() {
    const maxSafeLength = canvas.height / 4.5;
    let inputL1 = parseFloat(document.getElementById('l1_i').value);
    let inputL2 = parseFloat(document.getElementById('l2_i').value);
    
    if(inputL1 > maxSafeLength) {
        inputL1 = Math.floor(maxSafeLength);
        document.getElementById('l1_i').value = inputL1;
    }

    l1 = inputL1;
    l2 = inputL2;
    m1 = parseFloat(document.getElementById('m1_i').value);
    m2 = parseFloat(document.getElementById('m2_i').value);
    a1 = parseFloat(document.getElementById('a1_i').value) * Math.PI / 180;
    a2 = parseFloat(document.getElementById('a2_i').value) * Math.PI / 180;
    v1 = v2 = acc1 = acc2 = simTime = 0; trail = [];
}

function toggleSim() {
    isRunning = !isRunning;
    document.getElementById('runBtn').innerText = isRunning ? "Pause Simulation" : "Resume Simulation";
}

function drawRulers() {
    ctx.strokeStyle = '#151a22';
    ctx.fillStyle = '#444';
    ctx.font = '10px monospace';
    const cx = canvas.width / 2, cy = canvas.height / 5;

    ctx.beginPath();
    for (let x = -2000; x <= 2000; x += 50) {
        let px = cx + x;
        if (px < 0) continue;
        ctx.moveTo(px, 0); ctx.lineTo(px, 10);
        if (x % 100 === 0) ctx.fillText(x, px + 3, 10);
    }
    for (let y = -2000; y <= 2000; y += 50) {
        let py = cy + y;
        if (py < 0) continue;
        ctx.moveTo(0, py); ctx.lineTo(10, py);
        if (y % 100 === 0) ctx.fillText(y, 2, py - 3);
    }
    ctx.stroke();
}

function solvePhysics() {
    const g = parseFloat(document.getElementById('g_s').value) / 10;
    const damp = 1 - parseFloat(document.getElementById('d_s').value);
    document.getElementById('g_l').innerText = (g*10).toFixed(1);
    document.getElementById('d_l').innerText = (1-damp).toFixed(3);

    if (isRunning && !dragTarget) {
        let den = (2*m1 + m2 - m2*Math.cos(2*a1 - 2*a2));
        acc1 = (-g*(2*m1+m2)*Math.sin(a1) - m2*g*Math.sin(a1-2*a2) - 2*Math.sin(a1-a2)*m2*(v2*v2*l2 + v1*v1*l1*Math.cos(a1-a2))) / (l1*den);
        acc2 = (2*Math.sin(a1-a2)*(v1*v1*l1*(m1+m2) + g*(m1+m2)*Math.cos(a1) + v2*v2*l2*m2*Math.cos(a1-a2))) / (l2*den);
        v1 = (v1 + acc1) * damp; v2 = (v2 + acc2) * damp;
        a1 += v1; a2 += v2;
        simTime += 1/60;
    }

    const PE = -(m1 + m2) * g * l1 * Math.cos(a1) - m2 * g * l2 * Math.cos(a2);
    const KE = 0.5 * m1 * (l1 * v1)**2 + 0.5 * m2 * ((l1 * v1)**2 + (l2 * v2)**2 + 2 * l1 * l2 * v1 * v2 * Math.cos(a1 - a2));
    
    // Update Telemetry
    document.getElementById('t_a1').innerText = Math.round(a1 * 180/Math.PI % 360) + "°";
    document.getElementById('t_a2').innerText = Math.round(a2 * 180/Math.PI % 360) + "°";
    document.getElementById('t_t').innerText = simTime.toFixed(2) + "s";
    document.getElementById('t_e').innerText = Math.round((PE + KE)*100);
    document.getElementById('t_v2').innerText = v2.toFixed(3);
    document.getElementById('t_a2_acc').innerText = acc2.toFixed(4);
}

function draw() {
    ctx.fillStyle = '#010204'; ctx.fillRect(0, 0, canvas.width, canvas.height);
    solvePhysics();
    drawRulers();
    
    const cx = canvas.width / 2, cy = canvas.height / 5;
    const x1 = l1 * Math.sin(a1) + cx, y1 = l1 * Math.cos(a1) + cy;
    const x2 = x1 + l2 * Math.sin(a2), y2 = y1 + l2 * Math.cos(a2);

    if (isRunning) { trail.push({x: x2, y: y2}); if(trail.length > 150) trail.shift(); }
    ctx.strokeStyle = 'rgba(0, 242, 255, 0.1)'; ctx.beginPath();
    trail.forEach((p, i) => i === 0 ? ctx.moveTo(p.x, p.y) : ctx.lineTo(p.x, p.y));
    ctx.stroke();

    ctx.strokeStyle = '#00f2ff'; ctx.lineWidth = 3;
    ctx.beginPath(); ctx.moveTo(cx, cy); ctx.lineTo(x1, y1); ctx.lineTo(x2, y2); ctx.stroke();

    ctx.fillStyle = '#fff'; ctx.shadowBlur = 8; ctx.shadowColor = '#00f2ff';
    ctx.beginPath(); ctx.arc(x1, y1, Math.max(5, Math.sqrt(m1)*1.8), 0, Math.PI*2); ctx.fill();
    ctx.beginPath(); ctx.arc(x2, y2, Math.max(5, Math.sqrt(m2)*1.8), 0, Math.PI*2); ctx.fill();
    ctx.shadowBlur = 0;

    requestAnimationFrame(draw);
}

canvas.addEventListener('mousedown', e => {
    const cx = canvas.width/2, cy = canvas.height/5;
    const x1 = l1 * Math.sin(a1) + cx, y1 = l1 * Math.cos(a1) + cy;
    const x2 = x1 + l2 * Math.sin(a2), y2 = y1 + l2 * Math.cos(a2);
    const mx = e.clientX - 320, my = e.clientY;
    if (Math.hypot(mx-x1, my-y1) < 25) dragTarget = 1;
    else if (Math.hypot(mx-x2, my-y2) < 25) dragTarget = 2;
});
window.addEventListener('mouseup', () => dragTarget = null);
window.addEventListener('mousemove', e => {
    if(!dragTarget) return;
    const mx = e.clientX - 320, my = e.clientY, cx = canvas.width/2, cy = canvas.height/5;
    if(dragTarget === 1) a1 = Math.atan2(mx-cx, my-cy);
    else { const x1 = l1 * Math.sin(a1) + cx, y1 = l1 * Math.cos(a1) + cy; a2 = Math.atan2(mx-x1, my-y1); }
    document.getElementById('a1_i').value = Math.round(a1 * 180/Math.PI);
    document.getElementById('a2_i').value = Math.round(a2 * 180/Math.PI);
});

window.addEventListener('resize', () => { 
    canvas.width = window.innerWidth - 320; 
    canvas.height = window.innerHeight; 
    applyAndReset(); 
});

canvas.width = window.innerWidth - 320; 
canvas.height = window.innerHeight;
applyAndReset(); draw();
</script>
</body>
</html>